<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Busqueda por Categoría</title>
</head>
<body>

    <label for="categorySelect">Seleccione una categoría:</label>
    <select id="categorySelect">
        <option value="" disabled selected>Seleccione un género</option>
    </select>
    <div id="fetchResult"></div>

    <script>
        /*
        document.addEventListener('DOMContentLoaded', () => {
            fetchCategories();
        });
        */

        function fetchCategories() {
            fetch('http://localhost:3000/movies/genero')
                .then(response => response.json())
                .then(categories => {
                    const categorySelect = document.getElementById('categorySelect');
                    categories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category.genre;
                        option.textContent = category.genre;
                        categorySelect.appendChild(option);
                    });
                })
                .catch(error => console.error('Error fetching categories:', error));
        }

        document.getElementById('categorySelect').addEventListener('change', () => {
            const selectedCategory = document.getElementById('categorySelect').value;
            fetchData(selectedCategory);
        });

        function fetchData(category) {
            fetch(`http://localhost:3000/movies/LGen/${category}`)
                .then(response => response.json())
                .then(data => {
                    const fetchResultDiv = document.getElementById('fetchResult');
                    fetchResultDiv.innerHTML = '';
                    if (data.length > 0) {
                        data.forEach(item => {
                            fetchResultDiv.innerHTML += `<p>Título: ${item.title}</p>
                                                         <p>Año de Lanzamiento: ${item.year_release}</p>
                                                         <p> Idioma: ${item.original_language}
                                                         </p><p>Resumen: ${item.overview}</p>
                                                         <hr>`;
                        });
                    } else {
                        fetchResultDiv.innerHTML = '<p>No se encontraron resultados</p>';
                    }
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        //con un click en la pagina, limpiamos
        window.onload = fetchCategories;
        
                    
    </script>

</body>
</html>
